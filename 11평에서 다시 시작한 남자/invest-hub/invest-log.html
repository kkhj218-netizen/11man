<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>투자일지 – 실전 매매 기록</title>

  <style>
    :root {
      --bg: #f5f5f7;
      --card: #ffffff;
      --text-main: #111111;
      --text-sub: #555555;
      --border: #e2e2e7;
      --radius-lg: 22px;
      --radius-md: 14px;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: var(--bg);
      color: var(--text-main);
    }
    .wrap {
      max-width: 960px;
      margin: 0 auto;
      padding: 28px 16px 80px;
    }
    .top-nav {
      font-size: 13px;
      margin-bottom: 10px;
    }
    .top-nav a { color:#555; text-decoration:none; }
    .top-nav a:hover { text-decoration:underline; }

    header {
      padding: 18px 20px 18px;
      margin-bottom: 22px;
      border-radius: var(--radius-lg);
      background: #020617;
      color: #e5e7eb;
    }
    header h1 {
      margin: 0 0 6px;
      font-size: 22px;
    }
    header p {
      margin: 0;
      font-size: 13px;
      line-height: 1.7;
    }

    .section {
      background: var(--card);
      border-radius: var(--radius-md);
      padding: 18px 18px 20px;
      border: 1px solid var(--border);
      margin-bottom: 16px;
    }
    h2 {
      font-size: 17px;
      margin: 0 0 8px;
    }
    p {
      font-size: 14px;
      line-height: 1.7;
      color: var(--text-sub);
    }

    /* 날짜 리스트 카드 */
    .log-list {
      margin: 0;
      padding: 0;
    }
    .log-list-item {
      list-style: none;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid #e1e1e7;
      background: #ffffff;
      margin-bottom: 8px;
      transition: background 0.16s ease, transform 0.08s ease, box-shadow 0.16s ease;
    }
    .log-list-item:hover {
      background: #f9fafb;
      transform: translateY(-1px);
      box-shadow: 0 8px 18px rgba(0,0,0,0.04);
    }
    .log-link {
      text-decoration: none;
      color: inherit;
      display: block;
      width: 100%;
    }
    .log-date {
      font-size: 14px;
      font-weight: 600;
      color: #111827;
    }
    .log-meta {
      font-size: 12px;
      color: #6b7280;
      margin-top: 2px;
    }
    .log-pill {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 999px;
      background: #eef2ff;
      color: #4338ca;
      margin-left: 6px;
      white-space: nowrap;
    }

    .empty-text {
      font-size: 13px;
      color: #9ca3af;
      margin-top: 8px;
    }

    @media (max-width: 768px) {
      .wrap { padding: 22px 12px 60px; }
      .log-list-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 4px;
      }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top-nav">
      <a href="../invest-hub.html">← 투자허브로 돌아가기</a>
    </div>

    <header>
      <h1>투자일지</h1>
      <p>
        숫자보다 중요한 건 “어떤 생각으로 움직였는가”입니다.<br />
        매매를 할 때마다, 혹은 관망을 선택했을 때마다 날짜 하나씩만 쌓아둡니다.
      </p>
    </header>

    <section class="section">
      <h2>기록 가이드</h2>
      <p>
        ✔ <code>/logs/</code> 폴더에 날짜별 HTML 파일을 하나씩 만들어 둡니다. (예: <code>2025-01-23.html</code>)<br />
        ✔ <code>logs.json</code> 파일에 날짜, 요약, 태그만 추가해주면 이 페이지는 자동으로 갱신됩니다.<br />
        ✔ 이 파일(<code>invest-log.html</code>)은 더 이상 수정할 필요가 없습니다.
      </p>
    </section>

    <section class="section">
      <h2>최근 투자일지</h2>
      <div id="log-list"></div>
      <div id="log-empty" class="empty-text" style="display:none;">
        아직 등록된 투자일지가 없습니다. <code>/logs/logs.json</code>에 첫 기록을 추가해보세요.
      </div>
    </section>
  </div>

  <!-- ✅ JS: logs/logs.json 불러와서 자동 렌더링 -->
  <script>
    async function loadLogs() {
      const listEl = document.getElementById('log-list');
      const emptyEl = document.getElementById('log-empty');

      try {
        const res = await fetch('logs/logs.json', { cache: 'no-store' });
        if (!res.ok) {
          console.error('logs.json 불러오기 실패', res.status);
          emptyEl.style.display = 'block';
          return;
        }

        const data = await res.json();
        if (!Array.isArray(data) || data.length === 0) {
          emptyEl.style.display = 'block';
          return;
        }

        // ✅ 2번: 날짜 기준 최신순 정렬 (YYYY-MM-DD 형식 가정)
        const sorted = data.slice().sort((a, b) => {
          return (a.date < b.date) ? 1 : (a.date > b.date ? -1 : 0);
        });

        const ul = document.createElement('ul');
        ul.className = 'log-list';

        sorted.forEach(item => {
          const li = document.createElement('li');
          li.className = 'log-list-item';

          const a = document.createElement('a');
          a.className = 'log-link';
          // 3번: 클릭 시 상세 HTML로 이동 (파일명 = date + ".html" 가정)
          a.href = `logs/${item.file || (item.date + '.html')}`;

          const dateDiv = document.createElement('div');
          dateDiv.className = 'log-date';
          dateDiv.textContent = item.date;

          // 태그(요약) pill
          if (item.pill) {
            const pillSpan = document.createElement('span');
            pillSpan.className = 'log-pill';
            pillSpan.textContent = item.pill;
            dateDiv.appendChild(pillSpan);
          }

          const metaDiv = document.createElement('div');
          metaDiv.className = 'log-meta';
          metaDiv.textContent = item.summary || '';

          a.appendChild(dateDiv);
          a.appendChild(metaDiv);

          li.appendChild(a);
          ul.appendChild(li);
        });

        listEl.appendChild(ul);
      } catch (err) {
        console.error(err);
        emptyEl.style.display = 'block';
      }
    }

    loadLogs();
  </script>
</body>
</html>
